---
sidebar_position: 2
title: 'MediatorObservable'
---

`MediatorObservable` is a type of `Observable` that acts as an adapter between one or more source `Observable`s. It allows us to create a new observable stream based on the values of other observables.

For example, we can create a `MediatorObservable` that observes an Observable of a certain type and emits a new value based on the value of the source observable. 

```ts
const user = new Observable<User>();

const isLoggedIn = new MediatorObservable<boolean>();
isLoggedIn.add(user, (nextUser) => isLoggedIn.value = nextUser !== undefined);
```

* [Reference](#reference)
  * [new MediatorObservable(initialValue?)](#new-observableinitialvalue)
  * [addSource(source, onNext): this](#addsourcesource-onnext-this)
  * [mapSource(source, mapNext): this](#mapsourcesource-mapnext-this)
___
## Reference
### new MediatorObservable(initialValue?)
Creates a new `MediatorObservable` with an optional initial value.
#### Arguments
* `initialValue?` - The initial value of the `MediatorObservable`. Defaults to `undefined`.

#### Caveats
* It's possible to instantiate a `MediatorObservable` without an initial value, but it's not recommended, as its value will be `undefined` until it's set for the first time which can lead to unexpected behavior.
___

### addSource(source, onNext): this
Starts observing the given source and calls the `onNext` callback when the source emits a new value.

#### Arguments
* `source` - The source `Observable` to observe.
* `onNext` - The callback to be called when the source emits a new value. The `onNext` callback receives the new value of the source as an argument. In order to update the value of the `MediatorObservable`, call the [value setter](observable#set-value) with the new value.

#### Returns
`addSource` returns the `MediatorObservable` instance, so it can be chained with other methods.
___

### mapSource(source, mapNext): this
Starts observing the given source and calls the `onNext` callback when the source emits a new value.

#### Arguments
* `source` - The source `Observable` to observe.
* `mapNext` - The callback to be called when the source emits a new value. The `mapNext` callback receives the new value of the source as an argument and should return the new value of the `MediatorObservable`.

### Observing multiple sources
Consider the following scenario: We're developing a checkout page for a food delivery app. Orders can be placed only if the total amount is greater than 50 dollars and the address is within the delivery area.
To implement this requirement, we'll create two observables, `totalAmount` and `address`, and we'll merge their emissions in one new `MediatorObservable` called `isOrderValid`. By doing so, `totalAmount` and `address` will become the sources of the new `MediatorObservable`. 

```ts
const totalAmount = new Subject<number>();
const address = new Subject<Address>();

const isOrderValid = new MediatorObservable<number>();
mediator.add(totalAmount, (nextTotalAmount) => mediator.value = isOrderValid(nextTotalAmount, address.value));
mediator.add(address, (nextAddress) => mediator.value = isOrderValid(totalAmount.value, nextAddress));

function isOrderValid(totalAmount: number, address: Address): boolean {
  return totalAmount > 50 && address.isInDeliveryArea;
}
```



